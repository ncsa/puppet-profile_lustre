# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`profile_lustre::bindmounts`](#profile_lustrebindmounts): Create bindmounts (generally of Lustre) on a directory
* [`profile_lustre::client`](#profile_lustreclient): Manage Lustre for a client machine
* [`profile_lustre::firewall`](#profile_lustrefirewall): A short summary of the purpose of this class
* [`profile_lustre::install`](#profile_lustreinstall): Install Lustre client
* [`profile_lustre::lnet_router`](#profile_lustrelnet_router): Manage Lustre for an LNet router
* [`profile_lustre::module`](#profile_lustremodule): Configure and build lnet & lustre kernel modules
* [`profile_lustre::nativemounts`](#profile_lustrenativemounts): Mount Lustre filesystems on the client
* [`profile_lustre::service`](#profile_lustreservice): Configure the lnet service
* [`profile_lustre::telegraf::lustre_client_health`](#profile_lustretelegraflustre_client_health): Telegraf Lustre client health checks
* [`profile_lustre::tuning`](#profile_lustretuning): Apply Lustre tuning parameters using lctl.

### Defined types

* [`profile_lustre::bindmount_resource`](#profile_lustrebindmount_resource): Create a bindmount (generally of Lustre) on a directory
* [`profile_lustre::nativemount_resource`](#profile_lustrenativemount_resource): Mount Lustre filesystem on a directory

## Classes

### <a name="profile_lustrebindmounts"></a>`profile_lustre::bindmounts`

```
  profile_lustre::bindmounts::map:
    /scratch:
      #opts: "defaults,nosuid,nodev,ro"
      src_mountpoint: "/mnt/mount"
      src_path: "/mnt/mount/scratch"
```

#### Examples

##### 

```puppet
include profile_lustre::bindmounts
```

#### Parameters

The following parameters are available in the `profile_lustre::bindmounts` class:

* [`map`](#map)

##### <a name="map"></a>`map`

Data type: `Optional[ Hash ]`

mapping of (Lustre) filesystems to bindmounts

Example hiera parameter:

Default value: ``undef``

### <a name="profile_lustreclient"></a>`profile_lustre::client`

Manage Lustre for a client machine

#### Examples

##### 

```puppet
include profile_lustre::client
```

### <a name="profile_lustrefirewall"></a>`profile_lustre::firewall`

A short summary of the purpose of this class

#### Examples

##### 

```puppet
include profile_lustre::firewall
```

#### Parameters

The following parameters are available in the `profile_lustre::firewall` class:

* [`dports`](#dports)
* [`proto`](#proto)
* [`sources`](#sources)

##### <a name="dports"></a>`dports`

Data type: `Array[Integer]`

Destination ports that need to be open for the lustre service

##### <a name="proto"></a>`proto`

Data type: `String`

Protocol that needs to be open for the lustre service

##### <a name="sources"></a>`sources`

Data type: `Array[String]`

CIDR sources that need to be open for the lustre service.
This should include all of the Lustre servers and any LNET routers.
It may also need to other lustre client peers (need confirmation about this).

### <a name="profile_lustreinstall"></a>`profile_lustre::install`

Install Lustre client

#### Examples

##### 

```puppet
include profile_lustre::install
```

#### Parameters

The following parameters are available in the `profile_lustre::install` class:

* [`required_pkgs`](#required_pkgs)
* [`yumrepo`](#yumrepo)

##### <a name="required_pkgs"></a>`required_pkgs`

Data type: `Array[ String ]`

Packages that need to be installed for Lustre mounts to work.

##### <a name="yumrepo"></a>`yumrepo`

Data type: `Hash`

Hash of yumrepo resource for lustre yum repository

### <a name="profile_lustrelnet_router"></a>`profile_lustre::lnet_router`

Manage Lustre for an LNet router

#### Examples

##### 

```puppet
include profile_lustre::lnet_router
```

### <a name="profile_lustremodule"></a>`profile_lustre::module`

Configure and build lnet & lustre kernel modules

#### Examples

##### 

```puppet
include profile_lustre::module
```

#### Parameters

The following parameters are available in the `profile_lustre::module` class:

* [`is_lnet_router`](#is_lnet_router)
* [`lnet_conf_file`](#lnet_conf_file)
* [`local_networks`](#local_networks)
* [`modprobe_lustre_conf_file`](#modprobe_lustre_conf_file)
* [`remote_networks`](#remote_networks)

##### <a name="is_lnet_router"></a>`is_lnet_router`

Data type: `Boolean`

Is the node an LNet router or not?

##### <a name="lnet_conf_file"></a>`lnet_conf_file`

Data type: `String`

Full path to lnet.conf file, e.g. "/etc/lnet.conf"

##### <a name="local_networks"></a>`local_networks`

Data type: `Hash`

Hash of data to configure local NIDs on the host, in this form:
  <LOCAL_LND_1>:
    interface: "<ifc for LOCAL_LND_1>"
  ...
E.g.:
  tcp0:
    interface: "eth1"
  o2ib1:
    interface: "ib0"

##### <a name="modprobe_lustre_conf_file"></a>`modprobe_lustre_conf_file`

Data type: `String`

Full path to modprobe lustre.conf file, e.g. "/etc/modprobe.d/lustre.conf"

##### <a name="remote_networks"></a>`remote_networks`

Data type: `Hash`

Hash of data to configure routes to reach emote networks, in this form:
  <REMOTE_LND_A>:
    router_IPs: "IP_or_IP_list" (in format suitable for lustre.conf)
    router_net: "LND_for_router(s)"
  ...
E.g.:
  o2ib0:
    router_IPs: "172.28.16.[30-31]"
    router_net: "tcp0"

### <a name="profile_lustrenativemounts"></a>`profile_lustre::nativemounts`

```
  profile_lustre::nativemounts::map:
    /mnt/mount:
      src: "lustre-server1.local@o2ib,lustre-server2.local@o2ib:/filesystem"
      #opts: "defaults,nosuid,ro"  ## ??
```

#### Examples

##### 

```puppet
include profile_lustre::nativemounts
```

#### Parameters

The following parameters are available in the `profile_lustre::nativemounts` class:

* [`map`](#map)

##### <a name="map"></a>`map`

Data type: `Optional[ Hash ]`

mapping of Lustre filesystems to local mount points

Example hiera parameter:

Default value: ``undef``

### <a name="profile_lustreservice"></a>`profile_lustre::service`

Configure the lnet service

#### Examples

##### 

```puppet
include profile_lustre::service
```

#### Parameters

The following parameters are available in the `profile_lustre::service` class:

* [`lnet_service_enabled`](#lnet_service_enabled)
* [`lnet_service_name`](#lnet_service_name)
* [`lnet_service_running`](#lnet_service_running)

##### <a name="lnet_service_enabled"></a>`lnet_service_enabled`

Data type: `Boolean`

Boolean to determine if the lnet service is enabled

##### <a name="lnet_service_name"></a>`lnet_service_name`

Data type: `String`

String of the name of the lnet service

##### <a name="lnet_service_running"></a>`lnet_service_running`

Data type: `Boolean`

Boolean to determine if the lnet service is ensured running

### <a name="profile_lustretelegraflustre_client_health"></a>`profile_lustre::telegraf::lustre_client_health`

Telegraf Lustre client health checks

#### Examples

##### 

```puppet
include profile_lustre::telegraf::lustre_client_health
```

#### Parameters

The following parameters are available in the `profile_lustre::telegraf::lustre_client_health` class:

* [`enabled`](#enabled)
* [`script_cfg`](#script_cfg)
* [`telegraf_cfg`](#telegraf_cfg)

##### <a name="enabled"></a>`enabled`

Data type: `Boolean`

Enable or disable this health check

##### <a name="script_cfg"></a>`script_cfg`

Data type: `Hash`

Hash that controls the values for the script config file. See data/common.yaml for examples

##### <a name="telegraf_cfg"></a>`telegraf_cfg`

Data type: `Hash`

Hash of key:value pairs passed to telegraf::input as options

### <a name="profile_lustretuning"></a>`profile_lustre::tuning`

Apply Lustre tuning parameters using lctl.

#### Examples

##### 

```puppet
include profile_lustre::tuning
```

#### Parameters

The following parameters are available in the `profile_lustre::tuning` class:

* [`params`](#params)

##### <a name="params"></a>`params`

Data type: `Hash`

Hash of tuning parameters:
  "<key1>": "<value1>"
  "<key2>": "<value2">
Note: Keys may contain * as a wildcard. E.g.:
  "osc.*.max_pages_per_rpc": "4096"

## Defined types

### <a name="profile_lustrebindmount_resource"></a>`profile_lustre::bindmount_resource`

Assumes that we are bindmounting from a mount or sub-directory of
a mount.

#### Examples

##### 

```puppet
profile_lustre::bindmount_resource { '/scratch':
  #opts           => "defaults,bind,noauto,nosuid,nodev,ro"
  src_mountpoint => "/mnt/mount",
  src_path       => "/mnt/mount/scratch",
}
```

#### Parameters

The following parameters are available in the `profile_lustre::bindmount_resource` defined type:

* [`opts`](#opts)
* [`src_mountpoint`](#src_mountpoint)
* [`src_path`](#src_path)

##### <a name="opts"></a>`opts`

Data type: `Optional[String]`

Mount options. MUST include 'bind'. (Optional.)

Default value: `'defaults,bind,noauto,nodev,nosuid'`

##### <a name="src_mountpoint"></a>`src_mountpoint`

Data type: `String`

The mount point of the source we are bindmounting from.

##### <a name="src_path"></a>`src_path`

Data type: `String`

The location we are bindmounting from (either same as
src_mountpoint or a sub-directory).

### <a name="profile_lustrenativemount_resource"></a>`profile_lustre::nativemount_resource`

Mount Lustre filesystem on a directory

#### Examples

##### 

```puppet
profile_lustre::nativemount_resource { '/mnt/mount':
  src => 'lustre-server1.local@o2ib,lustre-server2.local@o2ib:/filesystem',
  #opts => 'defaults,nosuid,ro'  ## ??
}
```

#### Parameters

The following parameters are available in the `profile_lustre::nativemount_resource` defined type:

* [`opts`](#opts)
* [`src`](#src)

##### <a name="opts"></a>`opts`

Data type: `Optional[String]`

(Optional) mount options.

Default value: `'defaults,nodev,nosuid'`

##### <a name="src"></a>`src`

Data type: `String`

Lustre source for the mount (includes hostnames/IPs of Lustre servers
along with source filesystem/path.

